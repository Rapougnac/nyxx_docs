"use strict";(self.webpackChunknyxx_docs=self.webpackChunknyxx_docs||[]).push([[269],{9613:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(9496);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(n),m=a,g=d["".concat(s,".").concat(m)]||d[m]||p[m]||o;return n?r.createElement(g,i(i({ref:t},c),{},{components:n})):r.createElement(g,i({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7382:function(e,t,n){n.r(t),n.d(t,{assets:function(){return b},contentTitle:function(){return f},default:function(){return k},frontMatter:function(){return h},metadata:function(){return y},toc:function(){return v}});var r=n(2182),a=n(9028),o=n(9496),i=n(9613),l=n(3255),s=n(9205),u=n(1626),c="tabItem_btML";function p(e){var t,n,a,i=e.lazy,l=e.block,p=e.defaultValue,d=e.values,m=e.groupId,g=e.className,h=o.Children.map(e.children,(function(e){if((0,o.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),f=null!=d?d:h.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),y=(0,s.lx)(f,(function(e,t){return e.value===t.value}));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var b=null===p?p:null!=(t=null!=p?p:null==(n=h.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(a=h[0])?void 0:a.props.value;if(null!==b&&!f.some((function(e){return e.value===b})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+b+'" but none of its children has the corresponding value. Available values are: '+f.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var v=(0,s.UB)(),w=v.tabGroupChoices,k=v.setTabGroupChoices,x=(0,o.useState)(b),_=x[0],N=x[1],j=[],T=(0,s.o5)().blockElementScrollPositionUntilNextRender;if(null!=m){var C=w[m];null!=C&&C!==_&&f.some((function(e){return e.value===C}))&&N(C)}var O=function(e){var t=e.currentTarget,n=j.indexOf(t),r=f[n].value;r!==_&&(T(t),N(r),null!=m&&k(m,r))},M=function(e){var t,n=null;switch(e.key){case"ArrowRight":var r=j.indexOf(e.currentTarget)+1;n=j[r]||j[0];break;case"ArrowLeft":var a=j.indexOf(e.currentTarget)-1;n=j[a]||j[j.length-1]}null==(t=n)||t.focus()};return o.createElement("div",{className:"tabs-container"},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,u.Z)("tabs",{"tabs--block":l},g)},f.map((function(e){var t=e.value,n=e.label,a=e.attributes;return o.createElement("li",(0,r.Z)({role:"tab",tabIndex:_===t?0:-1,"aria-selected":_===t,key:t,ref:function(e){return j.push(e)},onKeyDown:M,onFocus:O,onClick:O},a,{className:(0,u.Z)("tabs__item",c,null==a?void 0:a.className,{"tabs__item--active":_===t})}),null!=n?n:t)}))),i?(0,o.cloneElement)(h.filter((function(e){return e.props.value===_}))[0],{className:"margin-vert--md"}):o.createElement("div",{className:"margin-vert--md"},h.map((function(e,t){return(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==_})}))))}function d(e){var t=(0,l.Z)();return o.createElement(p,(0,r.Z)({key:String(t)},e))}function m(e){var t=e.children,n=e.hidden,r=e.className;return o.createElement("div",{role:"tabpanel",hidden:n,className:r},t)}var g=["components"],h={title:"Writing your first bot",authors:"l7ssha",date:new Date("2021-09-20T00:00:00.000Z"),category:"guides",sidebar_position:1,description:"This tutorial shows how to create your first bot, with a simple ping-pong command.",hide_table_of_contents:!0},f=void 0,y={unversionedId:"guides/writing_your_first_bot",id:"guides/writing_your_first_bot",title:"Writing your first bot",description:"This tutorial shows how to create your first bot, with a simple ping-pong command.",source:"@site/docs/guides/writing_your_first_bot.mdx",sourceDirName:"guides",slug:"/guides/writing_your_first_bot",permalink:"/nyxx_docs/docs/guides/writing_your_first_bot",editUrl:"https://github.com/Rapougnac/nyxx_docs/tree/docusaurus/docs/guides/writing_your_first_bot.mdx",tags:[],version:"current",lastUpdatedBy:"Rapougnac",lastUpdatedAt:1652773645,formattedLastUpdatedAt:"5/17/2022",sidebarPosition:1,frontMatter:{title:"Writing your first bot",authors:"l7ssha",date:"2021-09-20T00:00:00.000Z",category:"guides",sidebar_position:1,description:"This tutorial shows how to create your first bot, with a simple ping-pong command.",hide_table_of_contents:!0},sidebar:"guideSidebar",previous:{title:"Getting Started",permalink:"/nyxx_docs/docs/intro"},next:{title:"Cache",permalink:"/nyxx_docs/docs/guides/cache"}},b={},v=[{value:"Creating project",id:"creating-project",level:3},{value:"First code",id:"first-code",level:3}],w={toc:v};function k(e){var t=e.components,n=(0,a.Z)(e,g);return(0,i.kt)("wrapper",(0,r.Z)({},w,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h3",{id:"creating-project"},"Creating project"),(0,i.kt)("p",null,"You can create a simple project using the built-in dart command ",(0,i.kt)("inlineCode",{parentName:"p"},"dart create"),":"),(0,i.kt)(d,{mdxType:"Tabs"},(0,i.kt)(m,{value:"bash",label:"Bash",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ dart create -t console-simple your-project-name && cd ./your-project-name\n"))),(0,i.kt)(m,{value:"powershell",label:"PowerShell",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ps1"},"> (dart create -t console-simple your-project-name) -and (cd ./your-project-name)\n")))),(0,i.kt)("p",null,"Replace ",(0,i.kt)("inlineCode",{parentName:"p"},"your-project-name")," with your desired name."),(0,i.kt)("p",null,"This command will create few files that are needed to start a project. There will be a ",(0,i.kt)("inlineCode",{parentName:"p"},"pubspec.yaml")," with basic project info and dependency declaration. There will also be a file created with name of your project in ",(0,i.kt)("inlineCode",{parentName:"p"},"bin")," directory. This is the main file that you would have to run to start the bot."),(0,i.kt)("p",null,"To add nyxx to your project, run ",(0,i.kt)("inlineCode",{parentName:"p"},"dart pub add nyxx"),". Your ",(0,i.kt)("inlineCode",{parentName:"p"},"pubspec.yaml")," file should then look similar to this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yml",metastring:'title="./pubspec.yaml"',title:'"./pubspec.yaml"'},'name: test\ndescription: A simple command-line application.\nversion: 1.0.0\n# homepage: https://www.example.com\n\nenvironment:\n  sdk: ">=2.14.2 <3.0.0"\n\ndependencies:\n# highlight-next-line\n  nyxx: ^3.0.0 # You may have a different version if you follow this guide \n\ndev_dependencies:\n  lints: ^1.0.0\n')),(0,i.kt)("p",null,"Now when if you execute the ",(0,i.kt)("inlineCode",{parentName:"p"},"dart pub get")," command in the project's root directory, nyxx should be pulled from repos:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ dart pub get\nResolving dependencies...\n+ async 2.8.2\n+ charcode 1.3.1\n+ collection 1.15.0\n+ http 0.13.3\n+ http_parser 4.0.0\n+ logging 1.0.2\n+ meta 1.7.0\n+ nyxx 3.0.0\n+ path 1.8.0\n+ pedantic 1.11.1\n+ source_span 1.8.1\n+ string_scanner 1.1.0\n+ term_glyph 1.2.0\n+ typed_data 1.3.0\nChanged 14 dependencies!\n")),(0,i.kt)("h3",{id:"first-code"},"First code"),(0,i.kt)("p",null,"With everything set up, we can now start coding our bot, but let's start with something easy.\nThis is simple bot which replies to ",(0,i.kt)("inlineCode",{parentName:"p"},"!ping")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"pong"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart",metastring:'title="./bin/your_project_name.dart"',title:'"./bin/your_project_name.dart"'},"import 'package:nyxx/nyxx.dart';\n\nvoid main() {\n  //highlight-start\n  final bot = NyxxFactory.createNyxxWebsocket(\"TOKEN\", GatewayIntents.allUnprivileged);\n\n  bot.eventsWs.onMessageReceived.listen((event) {\n    if (event.message.content == \"!ping\") {\n      event.message.channel.sendMessage(MessageBuilder.content('Pong!'));\n    }\n  });\n  //highlight-end\n}\n")),(0,i.kt)("p",null,"Let's explain what each line does:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart",metastring:'title="./bin/your_project_name.dart"',title:'"./bin/your_project_name.dart"'},'final bot = NyxxFactory.createNyxxWebsocket("TOKEN", GatewayIntents.allUnprivileged);\n')),(0,i.kt)("p",null,"Here we are creating and starting a new client with your token and desired gateway intents.\nIn this case the bot will request all intents except privileged ones."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart"},'bot.eventsWs.onMessageReceived.listen((event) {\n    if (event.message.content == "!ping") {\n      event.message.channel.sendMessage(MessageBuilder.content("Pong!"));\n    }\n});\n')),(0,i.kt)("p",null,"Here we are subscribing to the ",(0,i.kt)("inlineCode",{parentName:"p"},"onMessageReceived")," stream which will 'deliver' new messages to the handler.\nThe function is invoked with ",(0,i.kt)("inlineCode",{parentName:"p"},"MessageEvent")," objects which contain ",(0,i.kt)("inlineCode",{parentName:"p"},"Message")," objects for you to use."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart",metastring:'title="./bin/your_project_name.dart"',title:'"./bin/your_project_name.dart"'},'if (event.message.content == "!ping") {\n  event.message.channel.sendMessage(MessageBuilder.content("Pong!"));\n}\n')),(0,i.kt)("p",null,"Here we check if the message's content is equal to ",(0,i.kt)("inlineCode",{parentName:"p"},"!ping")," and if it is we'll send ",(0,i.kt)("inlineCode",{parentName:"p"},"pong")," message to the same channel. To send messages we have to access the channel which is in form of a ",(0,i.kt)("inlineCode",{parentName:"p"},"Cacheable")," object. This is because channel might not\nbe cached inside client."),(0,i.kt)("p",null,"So, let's try out:"),(0,i.kt)("p",null,"See? Very easy.\nNow, let's look how to respond to a message."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart",metastring:'title="./bin/your_project_name.dart"',title:'"./bin/your_project_name.dart"'},"if (event.message.content == '!ping') {\n  //highlight-start\n  final replyBuilder = ReplyBuilder.fromMessage(event.message);\n\n  event.message.channel.sendMessage(MessageBuilder.content('Pong!')..replyBuilder = replyBuilder);\n  //highlight-end\n}\n")),(0,i.kt)("p",null,"But the bot is mentionning us when it replies, so we'll need to use the ",(0,i.kt)("inlineCode",{parentName:"p"},"AllowedMentions")," class"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dart",metastring:'title="./bin/your_project_name.dart"',title:'"./bin/your_project_name.dart"'},"if (event.message.content == '!ping') {\n  final replyBuilder = ReplyBuilder.fromMessage(event.message);\n  //highlight-next-line\n  final allowedMentions = AllowedMentions()..allow(reply: false);\n\n  //highlight-next-line\n  event.message.channel.sendMessage(MessageBuilder.content('Pong!')..replyBuilder = replyBuilder..allowedMentions = allowedMentions);\n}\n")),(0,i.kt)("p",null,"And now, if you re-execute the command, you shouldn't be mentionned when the bot replies."),(0,i.kt)("br",null),(0,i.kt)("p",null,"That's all you need to create your first command."))}k.isMDXComponent=!0}}]);